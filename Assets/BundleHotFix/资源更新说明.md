# 资源更新BundleHotFix

## 使用说明

目前暂时支持csv 数据的更新

### step 1 

执行菜单->AssetBundle->Build AssetBundle (资源打包) 

打包资源在  工程目录/AssetBundles/Android

### step2

执行菜单 ->AssetBundle -> CompressFile(打包成服务器资源)

压缩文件在 工程目录/AssetBundles/ServerCompressAssets

### step3 

把第二步的压缩文件上传到nginx 服务器。 可以使用FileZila, IBM 服务器地址 192.168.1.172 ，sftp 协议， 文件目录 /home/youmeng/assetbundle



## 过程说明

1.对比资源版本号。版本信息由vercode 和 vername 两个属性，一个数字一个字符串。 版本名称vername 格式为 X.Y.Z ,X表示大版本号，表示前后是不兼容的版本，Y表示有功能上的修改，z表示修复bug。

```
本地的版本名称和服务器的版本名称对比时，x 不相等时不再进行更新。
还要对比vercode ,服务器的  vercode 比较大的情况下才更新。
```

2.资源文件检查，检查每一个资源是否有新版本，若有就加入下载列表。

3.下载文件。

4.解压文件

5.更新文件的信息，防止重复下载。

6.结束下载过程。新下载的文件后缀名为.temp。

7.全部的下载，解压完成后，用后缀名为.temp的文件替换原来的旧资源。

8.调用GameStart 的方法正式加载游戏。


## 引用插件

1.JsonDotNet JSON 文件解释 

2.7zip  文件压缩 解压

3.Loom 线程处理


## 文件简述

1.AssetBundle\ResourceInfoData.csv 。AssetBundle 文件信息列表，记录每个文件的版本号，hash码。

2.AssetBundle\resVer.txt 记录服务器资源的总体版本号码vercode 和版本名称vername。

3.Resources\Data\Josn\ResVersionData, 记录本地资源的版本号码vercode 和版本名称vername。

4.Resources/Data/ResourceInfoData.csv 文件信息的模板。
